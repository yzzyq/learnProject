import copy
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd
import xlwt
import os
from matplotlib.font_manager import FontProperties




if __name__ == '__main__':
##    three_all_recall_precise = [[[0.001, 0.5298013245033113, 0.898876404494382], [0.003, 0.5298013245033113, 0.898876404494382], [0.005, 0.5298013245033113, 0.898876404494382], [0.008, 0.5298013245033113, 0.898876404494382], [0.01, 0.5298013245033113, 0.898876404494382], [0.015, 0.5298013245033113, 0.898876404494382], [0.02, 0.5960264900662252, 0.9], [0.025, 0.695364238410596, 0.84], [0.03, 0.7417218543046358, 0.7466666666666667], [0.035, 0.7880794701986755, 0.68], [0.04, 0.8211920529801324, 0.62], [0.045, 0.8609271523178808, 0.5777777777777777], [0.05, 0.9006622516556292, 0.544], [0.055, 0.9205298013245033, 0.5054545454545455], [0.06, 0.9403973509933775, 0.47333333333333333], [0.065, 0.9602649006622517, 0.4461538461538462], [0.07, 1.0, 0.43142857142857144]],
##                                [[0.001, 0.5625, 0.9310344827586207], [0.003, 0.5625, 0.9310344827586207], [0.005, 0.5625, 0.9310344827586207], [0.008, 0.7083333333333334, 0.85], [0.01, 0.7916666666666666, 0.76], [0.015, 0.875, 0.56], [0.02, 0.9375, 0.45], [0.025, 0.9583333333333334, 0.368], [0.03, 0.9791666666666666, 0.31333333333333335], [0.035, 0.9791666666666666, 0.26857142857142857], [0.04, 0.9791666666666666, 0.235], [0.045, 0.9791666666666666, 0.2088888888888889], [0.05, 1.0, 0.192], [0.055, 1.0, 0.17454545454545456], [0.06, 1.0, 0.16], [0.065, 1.0, 0.1476923076923077], [0.07, 1.0, 0.13714285714285715]],
##                                [[0.001, 0.8214285714285714, 1.0], [0.003, 0.8214285714285714, 1.0], [0.005, 0.8571428571428571, 0.96], [0.008, 0.9285714285714286, 0.65], [0.01, 0.9285714285714286, 0.52], [0.015, 1.0, 0.37333333333333335], [0.02, 1.0, 0.28], [0.025, 1.0, 0.224], [0.03, 1.0, 0.18666666666666668], [0.035, 1.0, 0.16], [0.04, 1.0, 0.14], [0.045, 1.0, 0.12444444444444444], [0.05, 1.0, 0.112], [0.055, 1.0, 0.10181818181818182], [0.06, 1.0, 0.09333333333333334], [0.065, 1.0, 0.08615384615384615], [0.07, 1.0, 0.08]]]
##    three_all_recall_precise = [[[0.05, 0.893312101910828, 0.9838653104173974], [0.07, 0.893312101910828, 0.9838653104173974], [0.1, 0.893312101910828, 0.9838653104173974], [0.13, 0.893312101910828, 0.9838653104173974], [0.15, 0.893312101910828, 0.9838653104173974], [0.17, 0.893312101910828, 0.9838653104173974], [0.2, 0.893312101910828, 0.9838653104173974], [0.23, 0.893312101910828, 0.9838653104173974], [0.25, 0.893312101910828, 0.9838653104173974], [0.27, 0.893312101910828, 0.9838653104173974], [0.3, 0.9321656050955414, 0.9756666666666667], [0.33, 0.9684713375796178, 0.9215151515151515], [0.35, 0.9812101910828025, 0.8802857142857143], [0.37, 0.9898089171974522, 0.84], [0.4, 0.9974522292993631, 0.783], [0.43, 0.9980891719745223, 0.7288372093023255], [0.45, 0.9984076433121019, 0.6966666666666667], [0.47, 0.9990445859872611, 0.6674468085106383], [0.5, 0.9996815286624203, 0.6278], [0.53, 1.0, 0.5924528301886792], [0.55, 1.0, 0.5709090909090909], [0.57, 1.0, 0.5509738550622917], [0.6, 1.0, 0.5233333333333333], [0.63, 1.0, 0.4984126984126984], [0.65, 1.0, 0.48307692307692307], [0.67, 1.0, 0.46865671641791046], [0.7, 1.0, 0.44857142857142857]],
##                                [[0.05, 0.9028448738593666, 0.9847775175644028], [0.07, 0.9028448738593666, 0.9847775175644028], [0.1, 0.9028448738593666, 0.9847775175644028], [0.13, 0.9028448738593666, 0.9847775175644028], [0.15, 0.9028448738593666, 0.9847775175644028], [0.17, 0.9028448738593666, 0.9847775175644028], [0.2, 0.9634997316156736, 0.8975], [0.23, 0.984970477724101, 0.7978260869565217], [0.25, 0.9940955448201825, 0.7408], [0.27, 0.9973161567364466, 0.6881481481481482], [0.3, 0.998389694041868, 0.62], [0.33, 0.9989264626945786, 0.563939393939394], [0.35, 0.9989264626945786, 0.5317142857142857], [0.37, 0.9994632313472893, 0.5032432432432432], [0.4, 0.9994632313472893, 0.4655], [0.43, 0.9994632313472893, 0.4330232558139535], [0.45, 1.0, 0.414], [0.47, 1.0, 0.3963829787234043], [0.5, 1.0, 0.3726], [0.53, 1.0, 0.35150943396226414], [0.55, 1.0, 0.3387272727272727], [0.57, 1.0, 0.32689945604492016], [0.6, 1.0, 0.3105], [0.63, 1.0, 0.2957142857142857], [0.65, 1.0, 0.2866153846153846], [0.67, 1.0, 0.27805970149253734], [0.7, 1.0, 0.2661428571428571]],
##                                [[0.05, 0.916923076923077, 0.9197530864197531], [0.07, 0.9907692307692307, 0.7108167770419426], [0.1, 0.9969230769230769, 0.5], [0.13, 1.0, 0.3859857482185273], [0.15, 1.0, 0.3343621399176955], [0.17, 1.0, 0.29491833030852993], [0.2, 1.0, 0.2507716049382716], [0.23, 1.0, 0.21797451374916163], [0.25, 1.0, 0.2006172839506173], [0.27, 1.0, 0.18571428571428572], [0.3, 1.0, 0.16718106995884774], [0.33, 1.0, 0.15194015895278168], [0.35, 1.0, 0.14323490524460114], [0.37, 1.0, 0.13552960800667221], [0.4, 1.0, 0.1253374469726186], [0.43, 1.0, 0.11661284535342663], [0.45, 1.0, 0.11141583818992115], [0.47, 1.0, 0.10666229077781425], [0.5, 1.0, 0.10027769207034866], [0.53, 1.0, 0.09461426491994178], [0.55, 1.0, 0.091164095371669], [0.57, 1.0, 0.08795669824086604], [0.6, 1.0, 0.08356904088454616], [0.63, 1.0, 0.07957884427032322], [0.65, 1.0, 0.07714217896985522], [0.67, 1.0, 0.07483306470181902], [0.7, 1.0, 0.07161745262230057]]]

    three_all_recall_precise = [[[0.05, 0.84472049689441, 1.0], [0.07, 0.84472049689441, 1.0], [0.1, 0.84472049689441, 1.0], [0.13, 0.84472049689441, 1.0], [0.15, 0.84472049689441, 1.0], [0.17, 0.84472049689441, 1.0], [0.2, 0.84472049689441, 1.0], [0.23, 0.84472049689441, 1.0], [0.25, 0.8881987577639752, 0.9930555555555556], [0.27, 0.906832298136646, 0.9358974358974359], [0.3, 0.9192546583850931, 0.8554913294797688], [0.33, 0.9192546583850931, 0.7789473684210526], [0.35, 0.9254658385093167, 0.7376237623762376], [0.37, 0.9254658385093167, 0.6995305164319249], [0.4, 0.9316770186335404, 0.6493506493506493], [0.43, 0.9316770186335404, 0.6048387096774194], [0.45, 0.9316770186335404, 0.5769230769230769], [0.47, 0.9316770186335404, 0.5535055350553506], [0.5, 0.937888198757764, 0.5224913494809689], [0.53, 0.937888198757764, 0.4934640522875817], [0.55, 0.937888198757764, 0.47634069400630913], [0.57, 0.937888198757764, 0.45896656534954405], [0.6, 0.9440993788819876, 0.4393063583815029], [0.63, 0.9440993788819876, 0.4175824175824176], [0.65, 0.9440993788819876, 0.4053333333333333], [0.67, 0.9440993788819876, 0.39276485788113696], [0.7, 0.9440993788819876, 0.37623762376237624]],
                                [[0.05, 0.8767123287671232, 0.7529411764705882], [0.07, 0.8904109589041096, 0.5416666666666666], [0.1, 0.9178082191780822, 0.391812865497076],
[0.13, 0.9178082191780822, 0.3004484304932735], [0.15, 0.9178082191780822, 0.2607003891050584], [0.17, 0.9315068493150684, 0.23367697594501718], [0.2, 0.9315068493150684, 0.19825072886297376], [0.23, 0.9315068493150684, 0.17258883248730963], [0.25, 0.9315068493150684, 0.1585081585081585], [0.27, 0.9315068493150684, 0.1468682505399568], [0.3, 0.9315068493150684, 0.13229571984435798], [0.33, 0.9315068493150684, 0.12014134275618374], [0.35, 0.9315068493150684, 0.11333333333333333], [0.37, 0.9315068493150684, 0.10725552050473186], [0.4, 0.9315068493150684, 0.09912536443148688], [0.43, 0.9315068493150684, 0.09226594301221167], [0.45, 0.9315068493150684, 0.08808290155440414], [0.47, 0.9315068493150684, 0.08436724565756824], [0.5, 0.9315068493150684, 0.07925407925407925], [0.53, 0.9315068493150684, 0.0748074807480748], [0.55, 0.9315068493150684, 0.07211028632025451], [0.57, 0.9315068493150684, 0.06952965235173825], [0.6, 0.9315068493150684, 0.06608357628765792], [0.63, 0.9315068493150684, 0.06290471785383904], [0.65, 0.9315068493150684, 0.06098654708520179], [0.67, 0.9315068493150684, 0.05918189730200174], [0.7, 0.9315068493150684, 0.05661948376353039]],
                                [[0.05, 0.9, 0.07692307692307693], [0.07, 0.9, 0.054878048780487805], [0.1, 0.9, 0.03829787234042553], [0.13, 0.9, 0.029508196721311476], [0.15, 0.9, 0.02556818181818182], [0.17, 0.9, 0.022556390977443608], [0.2, 0.9, 0.019148936170212766], [0.23, 0.9, 0.016666666666666666], [0.25, 0.9, 0.015332197614991482], [0.27, 0.9, 0.014195583596214511], [0.3, 0.9, 0.01276595744680851], [0.33, 0.9, 0.011612903225806452], [0.35, 0.9, 0.010948905109489052], [0.37, 0.9, 0.010356731875719217], [0.4, 0.9, 0.009574468085106383], [0.43, 0.9, 0.00891089108910891], [0.45, 0.9, 0.008514664143803218], [0.47, 0.9, 0.008152173913043478], [0.5, 0.9, 0.007659574468085106], [0.53, 0.9, 0.007228915662650603], [0.55, 0.9, 0.00696594427244582], [0.57, 0.9, 0.006721433905899925], [0.6, 0.9, 0.006382978723404255], [0.63, 0.9, 0.006081081081081081], [0.65, 0.9, 0.005893909626719057], [0.67, 0.9, 0.005717916137229987], [0.7, 0.9, 0.00547112462006079]]]
    
    # three_all_recall_precise = [[[0.0, 0.25, 1.0], [0.05, 0.25, 1.0], [0.1, 0.5, 1.0], [0.15000000000000002, 0.5, 1.0], [0.2, 0.75, 1.0], [0.25, 1.0, 1.0], [0.30000000000000004, 1.0, 1.0], [0.35000000000000003, 1.0, 0.8], [0.4, 1.0, 0.8], [0.45, 1.0, 0.6666666666666666]],
    #                             [[0.0, 0.2727272727272727, 1.0], [0.05, 0.5454545454545454, 1.0], [0.1, 0.7272727272727273, 0.8888888888888888], [0.15000000000000002, 1.0, 0.9166666666666666], [0.2, 1.0, 0.7333333333333333], [0.25, 1.0, 0.6111111111111112], [0.30000000000000004, 1.0, 0.5238095238095238], [0.35000000000000003, 1.0, 0.4583333333333333], [0.4, 1.0, 0.4074074074074074], [0.45, 1.0, 0.36666666666666664]],
    #                             [[0.0, 0.18181818181818182, 1.0], [0.05, 0.2727272727272727, 0.6], [0.1, 0.5454545454545454, 0.75], [0.15000000000000002, 0.8181818181818182, 0.75], [0.2, 1.0, 0.7333333333333333], [0.25, 1.0, 0.5789473684210527], [0.30000000000000004, 1.0, 0.5], [0.35000000000000003, 1.0, 0.4230769230769231], [0.4, 1.0, 0.3793103448275862], [0.45, 1.0, 0.3333333333333333]],
    #                             [[0.0, 0.14754098360655737, 1.0], [0.05, 0.3442622950819672, 1.0], [0.1, 0.5081967213114754, 0.9393939393939394], [0.15000000000000002, 0.7049180327868853, 0.9555555555555556], [0.2, 0.8524590163934426, 0.896551724137931], [0.25, 0.9508196721311475, 0.8285714285714286], [0.30000000000000004, 0.9508196721311475, 0.7073170731707317], [0.35000000000000003, 0.9672131147540983, 0.6276595744680851], [0.4, 0.9672131147540983, 0.5514018691588785], [0.45, 0.9672131147540983, 0.4957983193277311]],
    #                             [[0.0, 0.16981132075471697, 1.0], [0.05, 0.32075471698113206, 1.0], [0.1, 0.49056603773584906, 1.0], [0.15000000000000002, 0.6226415094339622, 0.9705882352941176], [0.2, 0.7547169811320755, 0.9302325581395349], [0.25, 0.8490566037735849, 0.8653846153846154], [0.30000000000000004, 0.8679245283018868, 0.7666666666666667], [0.35000000000000003, 0.9056603773584906, 0.6956521739130435], [0.4, 0.9056603773584906, 0.6233766233766234], [0.45, 0.9245283018867925, 0.5697674418604651]]]


    myfont=FontProperties(fname='C:\Windows\Fonts\simhei.ttf',size=14)
    sns.set(font=myfont.get_name())
    sns.set_style('darkgrid',{"axes.facecolor": ".9"})
##    sns.set_palette('Set2')
    sns.set_context('paper',font_scale=1,rc={"lines.linewidth": 1.5})
    sns.set(font=myfont.get_name())
    sns.set_style("white")
    # plt.style.use('ggplot')
    plt.figure(figsize=(9,7))
    plt.title('权重1-0.5-0.5下阈值的大小与召回、精确的关系')
    plt.xlim((0.05,0.72))
    color_set = ['baby poop green','amber','windows blue']
    legend_set = ['S/N=[0,10]','S/N=[10,50]','S/N=[50,]']
##    fig,ax = plt.subplots()
    for index in range(len(three_all_recall_precise)):
        all_recall_precise = np.array(three_all_recall_precise[index])
        plt.scatter(all_recall_precise[:,0],
                    all_recall_precise[:,1],
                    c = sns.xkcd_rgb[color_set[index]],
                    marker = '*',
                    alpha=0.5)
        plt.plot(all_recall_precise[:,0],
                 all_recall_precise[:,1],
                 label= legend_set[index] + '召回率',
                 c = sns.xkcd_rgb[color_set[index]],
                 linestyle=':',
                 marker='|')
        plt.scatter(all_recall_precise[:,0],
                    all_recall_precise[:,2],
                    c = sns.xkcd_rgb[color_set[index]],
                    alpha=0.5)
        plt.plot(all_recall_precise[:,0],
                 all_recall_precise[:,2],
                 label= legend_set[index] + '精确率',
                 c = sns.xkcd_rgb[color_set[index]])
##    plt.legend(loc='best')
    ax = plt.gca()
    box = ax.get_position()
    ax.set_position([box.x0, box.y0, box.width*0.85 , box.height])
    plt.legend(bbox_to_anchor=(1.02, 1), loc=2, borderaxespad=0,fontsize = 9,
               handleheight = 3)
    plt.grid(True)
    

    plt.show()
